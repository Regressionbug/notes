

# 身高体重模型

假设身高体重模型为
$$
W=c_1H^{c_2}
$$
幂等模型
$$
\ln W=\ln c_1+c_2\ln H
$$
令
$$
k=\ln c_1
\\
c_1=e^k
$$
则
$$
k+\ln H \ c_2  = \ln W
$$

可写为
$$
\left [ \begin{matrix}
1 & \ln H
\end{matrix} \right ]

\left [ \begin{matrix}
k
\\
c_2
\end{matrix} \right ]=

\left [ \begin{matrix}
\ln W
\end{matrix} \right ]
$$


# 最小二乘

## 法线方程法

### 法线方程

$$
Ax=b
$$

方程组可写为
$$
x_1v_1+x_2v_2+...+x_nv_n=b
$$
可以把$b$看作是$A$的列向量$v_i$的线性组合，对应的组合系数是$x_1,...,x_n$

即向量$v_1,v_2,...,v_n$生成的空间中找到组合系数$x_1,...,x_n$，使$b$在这个空间上



当解不存在时，在向量空间$A$={$v_1,v_2,...,v_n$}中存在与$b$最接近的点：
即存在$\overline{x}$，满足
$$
b-A\overline{x} \perp 平面\lbrace Ax|x\epsilon R^n \rbrace
$$
把垂直性表示为矩阵的乘法，对于$R^n$上所有的$x$，
$$
(Ax)^T(b-A\overline{x})=0
$$
可写为
$$
x^TA^T(b-A\overline{x})=0
$$
这意味着$n$维向量$A^T(b-A\overline{x})$和$R^n$中其他的$n$维向量垂直，这表明
$$
A^T(b-A\overline{x})=0
$$
即
$$
A^TA\overline{x}=A^Tb
$$
称为法线方程，它的解$\overline{x}$是方程组$Ax=b$的最小二乘解



### 求解

最小二乘公式
$$
A^TAx=A^Tb
$$

代入数据
$$
A=\left [ \begin{matrix} 
1 & \ln h_1
\\
1 & \ln h_2
\\
\vdots & \vdots
\\
1 & \ln h_n
\end{matrix} \right ]
,
x=
\left [ \begin{matrix}
k
\\
c_2
\end{matrix} \right ],
b=\left [ \begin{matrix} 
\ln w_1
\\
\ln w_2
\\
\vdots
\\
\ln w_n
\end{matrix} \right ]
$$

得
$$
\left [ \begin{matrix} 
a & b
\\
c & d
\end{matrix} \right ]
\left [ \begin{matrix}
k
\\
c_2
\end{matrix} \right ]=
\left [ \begin{matrix}
y_1
\\
y_2
\end{matrix} \right ]
$$



## QR分解

### Gram-Schmidt正交分解

$$
A=QR
$$

误差满足
$$
e=\parallel Ax-b \parallel_2=\parallel QRx-b \parallel_2=\parallel Rx-Q^Tb \parallel_2
$$
求解
$$
Rx=Q^Tb
$$
即为最小二乘解

误差为

### Household变换